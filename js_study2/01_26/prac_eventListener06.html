<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>prac_eventListener06</title>
    <style>
      div {
        margin-bottom: 5px;
      }
      input {
        width: 100px;
      }

      label {
        display: inline-block;
        width: 100px;
      }
      button {
        margin-right: 30px;
      }
      .init {
        margin-left: 20px;
      }
    </style>
  </head>
  <body>
    <h3>ì‚°ìˆ˜ ë¬¸ì œë¥¼ í’€ì–´ ë´…ì‹œë‹¤.</h3>
    <p>ìë™ìœ¼ë¡œ ë¬¸ì œê°€ ë§Œë“¤ì–´ì§‘ë‹ˆë‹¤. ë‹µ ì…ë ¥ í›„ ì±„ì  ë²„íŠ¼ì„ ëˆ„ë¥´ì„¸ìš”.</p>
    <p>
      ë‹¤ì‹œ ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ìƒˆë¡œìš´ ë¬¸ì œê°€ ì¶œë ¥ë©ë‹ˆë‹¤. ë‚˜ëˆ„ê¸° ê²°ê³¼ëŠ” ì •ìˆ˜ì…ë‹ˆë‹¤.
    </p>
    <hr />
    <form>
      <div>
        <label for="p1"></label>
        <input class="answer" id="p1" type="text" />
      </div>
      <div>
        <label for="p2"></label>
        <input class="answer" id="p2" type="text" />
      </div>
      <div>
        <label for="p3"></label>
        <input class="answer" id="p3" type="text" />
      </div>
      <div>
        <label for="p4"></label>
        <input class="answer" id="p4" type="text" />
      </div>
      <div>
        <button>ì±„ì </button>
        <span class="result">0</span>
        <input class="init" type="button" value="ë‹¤ì‹œí•˜ê¸°" />
      </div>
    </form>

    <script>
      const form = document.querySelector("form");
      const myAnswerArr = document.querySelectorAll(".answer");
      const labels = document.querySelectorAll("label");
      const correctAnswerArr = new Array(labels.length);
      const result = document.querySelector(".result");
      const init = document.querySelector(".init");
      let count = 0;

      function makeProblem() {
        // 2ê°œ ìˆ«ì or 3ê°œ ìˆ«ìë¡œ ë§Œë“¤ì§€
        let numberOfNumbers = Math.floor(Math.random() * 2);
        let problem = "";

        problem += randomNum();

        for (let i = 0; i < numberOfNumbers * 2 + 1; i += 2) {
          problem += randomSign();
          problem += randomNum();
        }

        return problem;
      }

      function randomNum() {
        // ë²”ìœ„ 1 ~ 20ê¹Œì§€
        return Math.floor(Math.random() * 20) + 1;
      }

      function randomSign() {
        let num = Math.floor(Math.random() * 4);
        let sign;
        switch (num) {
          case 0:
            sign = "+";
            break;
          case 1:
            sign = "-";
            break;
          case 2:
            sign = "*";
            break;
          case 3:
            sign = "/";
            break;
          default:
            sign = "+";
            break;
        }
        return sign;
      }

      function initProblem(labels) {
        console.clear();
        labels.forEach((value, index) => {
          const problem = makeProblem();
          correctAnswerArr[index] = Math.floor(eval(problem));
          value.innerText = problem;
          myAnswerArr[index].value = "";
          labels[index].style.textDecoration = "none";
        });
        count = 0;
        result.innerHTML = count;
        console.log(correctAnswerArr);
      }

      // ë¬¸ì œ ì´ˆê¸°í™”
      initProblem(labels);

      // ì±„ì í–ˆì„ë•Œ
      form.addEventListener("submit", (event) => {
        event.preventDefault();
        count = 0;
        myAnswerArr.forEach((input, index) => {
          if (input.value != correctAnswerArr[index]) {
            labels[index].style.textDecoration = "line-through";
          } else {
            labels[index].style.textDecoration = "none";
            count++;
          }
          result.innerHTML = count;

          setTimeout(() => {
            if (count == labels.length) {
              alert("ì¶•í•˜í•©ë‹ˆë‹¤ğŸ‰ 100ì ì…ë‹ˆë‹¤!");
            }
            count = 0;
          }, 0);
        });
      });

      // ë‹¤ì‹œí•˜ê¸°
      init.addEventListener("click", () => {
        initProblem(labels);
      });
    </script>
  </body>
</html>
